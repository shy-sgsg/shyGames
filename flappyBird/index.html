<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird Pro</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-wrapper">
        <div class="game-container">
            <h1>Flappy Bird</h1>
            <div id="game-info">
                <p>åˆ†æ•°: <span id="score">0</span></p>
                <p id="message">ç‚¹å‡»å±å¹•æˆ–æŒ‰ç©ºæ ¼é”®å¼€å§‹</p>
            </div>
            <canvas id="gameCanvas" width="400" height="600"></canvas>
            
            <div id="startScreen">
                <div class="content">
                    <h2>Flappy Bird</h2>
                    <p>å‡†å¤‡å¥½æŒ‘æˆ˜äº†å—ï¼Ÿ</p>
                    <button id="startGameBtn">å¼€å§‹æ¸¸æˆ</button>
                </div>
            </div>
        </div>
        
        <div class="game-controls">
            <button id="pauseBtn" class="control-btn">æš‚åœ</button>
            <button id="showLeaderboardBtn" class="control-btn">æ’è¡Œæ¦œ</button>
            <button id="returnBtn" class="control-btn">è¿”å›ä¸»é¡µ</button>
        </div>
    </div>

    <div id="leaderboardModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeLeaderboardBtn">&times;</span>
            <h2>ğŸ† æ’è¡Œæ¦œ ğŸ†</h2>
            <ol id="leaderboard" class="leaderboard-list">
                </ol>
        </div>
    </div>

    <div id="scoreModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" id="closeScoreModalBtn">&times;</span>
            <h2 id="finalScoreTitle">æ¸¸æˆç»“æŸï¼</h2>
            <p id="finalScoreText"></p>
            <div id="submit-container">
                <p id="modalMessage">æ­å–œè¿›å…¥å‰åï¼è¯·è¾“å…¥ä½ çš„åå­—ï¼š</p>
                <input type="text" id="playerName" placeholder="ç©å®¶åç§°" maxlength="15">
                <button id="submitScoreBtn" class="modal-btn">æäº¤åˆ†æ•°</button>
            </div>
            <div id="retry-container">
                <button id="restartBtn" class="modal-btn">å†è¯•ä¸€æ¬¡</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
      
        const firebaseConfig = {
            apiKey: "AIzaSyCIRI2D9937f3iwtCJXU6zabDMYT0R18dU",
            authDomain: "game-2048-935e4.firebaseapp.com",
            projectId: "game-2048-935e4",
            storageBucket: "game-2048-935e4.appspot.com",
            messagingSenderId: "561986111957",
            appId: "1:561986111957:web:129c25516ad68c2920d55c"
        };

        // å…¨å±€å˜é‡ï¼Œç”¨äºç¦»çº¿æ¨¡å¼åˆ¤æ–­
        window.isOfflineMode = false;

        try {
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);
            
            // å°† Firebase åŠŸèƒ½æŒ‚è½½åˆ° window å¯¹è±¡ï¼Œä»¥ä¾¿ script.js å¯ä»¥è®¿é—®
            window.db = db;
            window.collection = collection;
            window.addDoc = addDoc;
            window.getDocs = getDocs;
            window.query = query;
            window.orderBy = orderBy;
            window.limit = limit;
            console.log("Firebase connected successfully!");
        } catch (e) {
            console.error("Firebase initialization failed: ", e);
            window.isOfflineMode = true; // è¿æ¥å¤±è´¥ï¼Œè¿›å…¥ç¦»çº¿æ¨¡å¼
        }
    </script>
    
    <script src="script.js"></script>
</body>
</html>